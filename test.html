<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Rectangles</title>
</head>

<body>

    <canvas id="myCanvas" width="600" height="600" style="border:1px solid #000000;"></canvas>

    <script>
        const inent = 10;  // Отступ между прямоугольниками
        const rectWidth = 30;  // Ширина основного прямоугольника
        const rectHeight = 145; // Высота основного прямоугольника

        function findDopRectangles(canvasWidth, canvasHeight, lengthRect, widthRect) {
            let dopHoriz = { horizontal: 0, vertical: 0 };
            let dopVert = { horizontal: 0, vertical: 0 };
            if (lengthRect + rectHeight + inent <= canvasWidth) {
                dopHoriz.horizontal++;
                while (lengthRect + (rectHeight + inent) * (dopHoriz.horizontal + 1) <= canvasWidth) {
                    dopHoriz.horizontal++;
                }
                if (rectWidth + inent + inent <= canvasHeight) {
                    dopHoriz.vertical++;
                    
                    while ((rectWidth + inent) * (dopHoriz.vertical + 1) + inent <= canvasHeight) {
                        dopHoriz.vertical++;
                    }
                } else {
                    dopHoriz.horizontal = 0;
                }
            } else if (widthRect + rectWidth + inent <= canvasHeight) {
                dopVert.vertical++;
                while (widthRect + (rectWidth + inent) * (dopVert.vertical + 1) <= canvasHeight) {
                    dopVert.vertical++;
                }
                if (rectHeight + inent + inent <= canvasWidth) {
                    dopVert.horizontal++;
                    while ((rectHeight + inent) * (dopVert.horizontal + 1) + inent <= canvasWidth) {
                        dopVert.horizontal++;
                    }
                } else {
                    dopVert.vertical =  0;
                }
            }
            
            return [dopHoriz, dopVert];
        }

        function findNumberOfRectangles(canvasWidth, canvasHeight) {
            let numRectangles = {};

            let numHorizontal = Math.floor((canvasWidth - inent) / (rectWidth + inent));
            let lengthRect = numHorizontal * (rectWidth + inent) + inent;
            let numVertical = Math.floor((canvasHeight - inent) / (rectHeight + inent));
            let widthRect = numVertical * (rectHeight + inent) + inent;

            let [dopHoriz, dopVert] = findDopRectangles(canvasWidth, canvasHeight, lengthRect, widthRect)

            if (numHorizontal != 0 && numVertical != 0) {
                numRectangles = { horizontal: numHorizontal, vertical: numVertical, dopHoriz: dopHoriz, dopVert: dopVert };
            } else {
                alert('Не подходящие параметры');
            }

            return numRectangles;
        }

        function drawRectangles(canvasId, rectanglesData) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');

            ctx.clearRect(0, 0, canvas.width, canvas.height); // Очищаем канвас перед отрисовкой

            // Основные прямоугольники (горизонтальные)
            for (let i = 0; i < rectanglesData.vertical; i++) {
                for (let j = 0; j < rectanglesData.horizontal; j++) {
                    ctx.fillStyle = 'lightblue';
                    ctx.fillRect(
                        inent + j * (rectWidth + inent),
                        inent + i * (rectHeight + inent),
                        rectWidth,
                        rectHeight
                    );
                }
            }
            console.log(rectanglesData.dopHoriz)
            // Дополнительные горизонтальные прямоугольники
            for (let j = 0; j < rectanglesData.dopHoriz.vertical; j++) {
                for (let i = 0; i < rectanglesData.dopHoriz.horizontal; i++) {
                    ctx.fillStyle = 'lightgreen';
                    ctx.fillRect(
                        inent + rectanglesData.horizontal * (rectWidth + inent) + i * (rectHeight + inent),
                        (inent + rectWidth) * j + inent,
                        rectHeight, // Поменяли ширину на высоту
                        rectWidth  // Поменяли высоту на ширину
                    );
                }
            }

            console.log(rectanglesData.dopVert)
            // Дополнительные вертикальные прямоугольники
            for (let j = 0; j < rectanglesData.dopVert.horizontal; j++) {
                for (let i = 0; i < rectanglesData.dopVert.vertical; i++) {
                    ctx.fillStyle = 'lightcoral';
                    ctx.fillRect(
                        inent + j * (rectHeight + inent),
                        inent + rectanglesData.vertical * (rectHeight + inent) + i * (rectWidth + inent),
                        rectHeight, // Поменяли ширину на высоту
                        rectWidth  // Поменяли высоту на ширину
                    );
                }
            }
        }

        // Параметры канваса
        const canvasWidth = 600;
        const canvasHeight = 600;

        // Найти количество прямоугольников
        const rectanglesData = findNumberOfRectangles(canvasWidth, canvasHeight);

        // Нарисовать прямоугольники на канвасе
        drawRectangles('myCanvas', rectanglesData);

    </script>

</body>

</html>